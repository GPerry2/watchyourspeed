function querystring(e){for(var t,a=new RegExp("(?:\\?|&)"+e+"=(.*?)(?=&|$)","gi"),s=[];null!=(t=a.exec(document.location.search));)s.push(t[1]);return s}function changeFontSize(e,t){t?deleteCookie("fontsize"):setCookie("fontsize",e),$("body").css("font-size",e),$("#increaseFontSize")[0].disabled="1.5em"==e,$("#decreaseFontSize")[0].disabled=".7em"==e,$.isFunction(window.setPageTabHeight)&&setPageTabHeight(),setConsistentHeight(".tabNavigation",".nav-tabs a"),setConsistentHeight(".carousel",".item"),"undefined"!=typeof $gallery&&($gallery.flickity("resize"),setConsistentHeightHP(".r5",".linkBoxInside"))}function increaseFontSize(){var e=getCookie("fontsize")||"1.1em";changeFontSize(Math.min(parseFloat(e)+.1,1.5)+"em")}function decreaseFontSize(){var e=getCookie("fontsize")||".9em";changeFontSize(Math.max(parseFloat(e)-.1,.7)+"em")}function resetFontSize(){changeFontSize("1em",!0)}function applyFontSize(){var e=getCookie("fontsize");e&&changeFontSize(e)}function setCookie(e,t){var a=new Date;a.setTime(a.getTime()+864e5),document.cookie=e+"="+t+";path=/;expires="+a.toUTCString()}function getCookie(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null}function deleteCookie(e){document.cookie=e+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function gglTranslate(e){var t;t=""!=document.referrer?encodeURIComponent(document.referrer):"http%3a%2f%2fwww1.toronto.ca%2f",document.location.href="http://translate.google.com/translate?u="+t+"&sl=en&tl="+e+"&hl=en&ie=UTF-8"}function translatePage(){document.location.href="/wps/portal/contentonly?vgnextoid=4be8b9bd23805410VgnVCM10000071d60f89RCRD&vgnextchannel=8e79f9be8db1c310VgnVCM1000006cd60f89RCRD"}function setConsistentHeight(e,t){var a,s=$(e),i=[];s.each(function(){var e=$(this).find(t);e.length&&(e.each(function(){$(this).css("height","auto")}),e.each(function(){i.push($(this).height())}),a=Math.max.apply(null,i)+10,e.each(function(){$(this).css("height",a+"px")}))})}function dismissLD(){document.cookie="lddismiss=true; path=/"}function processLDResponse(e){if("Notice"==e.items.title){var t='<div class="modal fade" tabindex="-1" role="dialog" id="ldModal" style="z-index: 9999999;"><div class="modal-dialog"><div class="modal-content">';t+='<div class="modal-header">',t+='<h4 class="modal-title">'+e.items.title+'</h4></div><div class="modal-body"><p>'+e.items.summary+"</p></div>",t+='<div class="modal-footer" style="text-align: center;"><button onclick="dismissLD();" type="button" class="btn btn-primary" data-dismiss="modal">Continue</button>',t+="</div></div></div></div>",$("body").append(t),$(".modal a").css("text-decoration","underline"),$("#ldModal").modal({backdrop:!1})}}function formatDate(e){var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=e.substring(0,4),s=e.substring(5,7),i=parseInt(e.substring(8,10));return t[parseInt(s)-1]+" "+i+", "+a}window.cot_bower_enabled=!0,$(function(){if(""!=querystring("tab")&&$(".tabNavigation").length>0){$(".tabNavigation ul.nav li.active").removeClass("active"),$(".tabNavigation .tab-content .tab-pane.active").removeClass("active");var e=".tabNavigation ul.nav li:eq("+parseInt(querystring("tab"))+")";$(e).addClass("active"),e=".tabNavigation .tab-content .tab-pane:eq("+parseInt(querystring("tab"))+")",$(e).addClass("active")}});var cot_app=function(e,t){this.name=e,$.extend(this,{hasHeader:!0,hasFooter:!0,hasContentTop:!0,hasContentBottom:!0,hasContentRight:!0,hasContentLeft:!0,hasLeftNav:!1,searchcontext:"INTER",includeFormValidation:!1,includePlaceholders:!1,includeMultiSelect:!1,includeOMS:!1,includeFullCalendar:!1,includeDatePicker:!1,includeEditableSelect:!1},t||{}),this.loadLibraries=void 0===window.cot_bower_enabled,this.baseUrl=this.loadLibraries?"../corev1.1/":"",this.data={},this.forms={},this.breadcrumbItems=[],this.isRendered=!1};cot_app.prototype.setTitle=function(e){$("#app-header h1").html(e)},cot_app.prototype.setBreadcrumb=function(e,t){return this.breadcrumbItems=e,t||this.breadcrumbItems.push({name:this.name}),this._renderBreadcrumb(),this},cot_app.prototype._renderBreadcrumb=function(){var e=$("#app-breadcrumb");if(e.length)if(this.breadcrumbItems.length){var t='<li><a href="http://www.toronto.ca"><span class="glyphicon glyphicon-home" style="margin-right: 5px;"></span>City of Toronto</a></li>',a=this.breadcrumbItems.length-1;$.each(this.breadcrumbItems,function(e,s){if(s.name){t+="<li>"+(s.link&&e<a?'<a href="'+s.link+'">'+s.name+"</a>":s.name)+"</li>"}}),e.find("ol.breadcrumb").html(t),e.show()}else e.hide()},cot_app.prototype.loadContent=function(e){var t=this;$.ajax({url:e.url,type:e.type?e.type:"GET",cache:e.cache?e.cache:"true",dataType:e.dataType?e.dataType:"jsonp",success:function(a){if(a=e.skiproot&&e.skiproot?a=a[0]:a,$.each(a.items,function(e,a){t.data[a.title]=a.summary}),!e.success)return t;e.success(a)},error:function(t,a,s){e.error?e.error():alert("Error: The application was unable to load data.")}})},cot_app.prototype.getTeaserModal=function(e){var t="";return e.title&&e.body?(t+="<p><button ",t+=e.btnclass?'class="'+e.btnclass+'" ':"",t+="onclick=\"$('#teaserModal').modal()\">"+e.title+"</button></p>",t+='<div class="modal fade" id="teaserModal" tabindex="-1" role="dialog" aria-labelledby="teaserModalLabel" aria-hidden="true">',t+='<div class="modal-dialog">',t+='<div class="modal-content">',t+='<div class="modal-header"><button class="close" type="button" data-dismiss="modal"> <span aria-hidden="true">&times;</span> <span class="sr-only">Close</span></button>',t+='<h2 id="teaserModalLabel" class="modal-title">'+e.title+"</h2>",t+="</div>",t+='<div id="teaserModalBody" class="modal-body">'+e.body+"</div>",t+='<div class="modal-footer">',t+='<button class="btn btn-default" type="button" data-dismiss="modal">Close</button>',t+="</div></div></div></div>"):t+="<p class='hasError'>Error!</p>",t},cot_app.prototype.getTeaserStandard=function(e){var t="";return e.modal?t+=e.modal&&e.title&&e.body?this.getModalHTML(e.title,e.body):"":(t+=e.title?"<div class='componentTitle'><h2>"+e.title+"</h2></div>":"",t+=e.body?"<div class='article media componentBody'>"+e.body+"</div>":""),t},cot_app.prototype.render=function(e){if(this.isRendered)throw new Error("App is already rendered");var t=document.createElement("div");t.id="appCode";var a=document.createElement("div");a.id="appDisplay",$("#appDisplay,#appCode").addClass("hide"),$("body").append(t,a),this.loadLibraries&&($("#appCode").append('<link rel="stylesheet" href="'+this.baseUrl+'css/cot_app.css">'),$("#appCode").append('<script type="text/javascript" src="'+this.baseUrl+'js/jquery.cookie.js"></script>'),this.includeFormValidation&&($("#appCode").append('<script type="text/javascript" src="'+this.baseUrl+'js/formValidation.min.js"></script><script type="text/javascript" src="'+this.baseUrl+'js/framework/bootstrap.min.js"></script><link rel="stylesheet" href="'+this.baseUrl+'css/formValidation.min.css">'),$("#appCode").append('<link rel="stylesheet" href="'+this.baseUrl+'css/intlTelInput.css"><script type="text/javascript" src="'+this.baseUrl+'js/intlTelInput.min.js">'),$("#appCode").append('<script type="text/javascript" src="'+this.baseUrl+'js/cot_forms.js">'),$("#appCode").append('<script type="text/javascript" src="'+this.baseUrl+'js/jquery.maskedinput.js">')),this.includeEditableSelect&&$("#appCode").append('<link rel="stylesheet" href="'+this.baseUrl+'css/jquery-editable-select.css"><script type="text/javascript" src="'+this.baseUrl+'js/jquery-editable-select.js"></script>'),this.includePlaceholders&&$("#appCode").append('<script type="text/javascript" src="'+this.baseUrl+'js/placeholders.min.js"></script>'),this.includeMultiSelect&&$("#appCode").append('<link rel="stylesheet" href="'+this.baseUrl+'css/bootstrap-multiselect.css"><script type="text/javascript" src="'+this.baseUrl+'js/bootstrap-multiselect.js"></script>'),this.includeOMS&&$("#appCode").append('<script type="text/javascript" src="'+this.baseUrl+'js/oms.min.js"></script>'),this.includeFullCalendar&&$("#appCode").append('<link rel="stylesheet" media="print" href="'+this.baseUrl+'css/fullcalendar.print.css"><script type="text/javascript" src="'+this.baseUrl+'js/fullcalendar.min.js"></script><script type="text/javascript" src="'+this.baseUrl+'js/moment.min.js"></script>'),this.includeDatePicker&&$("#appCode").append('<link rel="stylesheet" href="'+this.baseUrl+'css/bootstrap-datetimepicker.css"><script type="text/javascript" src="'+this.baseUrl+'js/moment.min.js"></script><script type="text/javascript" src="'+this.baseUrl+'js/bootstrap-datetimepicker.js"></script>'),this.includeRangePicker&&$("#appCode").append('<link rel="stylesheet" href="'+this.baseUrl+'css/daterangepicker.css"><script type="text/javascript" src="'+this.baseUrl+'js/moment.min.js"></script><script type="text/javascript" src="'+this.baseUrl+'js/daterangepicker.js"></script>'),this.includeLogin&&$("#appCode").append('<script type="text/javascript" src="'+this.baseUrl+'js/cot_login.js"></script>'));var s=this;return $("#appDisplay").load(s.baseUrl+"html/cot_template_page.html #cot-template-page",function(t,a,i){switch($("div.securesite img").attr("src",s.baseUrl+"img/lock.png"),s.setTitle(s.name),s._renderBreadcrumb(),s.searchcontext){case"INTRA":$("#headersearch").attr("action","http://insideto-search.toronto.ca/search"),$("#headersearch #q").attr("placeholder","Search Inside Toronto..."),$("#sf_client").val("insideto-search"),$("#sf_proxystylesheet").val("insideto-search"),$("#sf_site").val("InsideTO-All");break;case"311":$("#headersearch").attr("action","http://insideto-search.toronto.ca/search"),$("#headersearch q").attr("placeholder","Search the 311 Knowledge Base..."),$("#sf_client").val("311KBSTAFF"),$("#sf_proxystylesheet").val("311KBSTAFF"),$("#sf_site").val("311KB");break;default:$("#headersearch").attr("action","http://search.toronto.ca/search"),$("#headersearch q").attr("placeholder",""),$("#sf_client").val("Toronto"),$("#sf_proxystylesheet").val("_common_"),$("#sf_site").val("TorontoWebsite"),$(".sf_311").remove()}s.hasLeftNav?($("#app-nav-left").removeClass("hide"),$("#app-content-full").addClass("col-sm-9")):$("#app-nav-left").remove(),s.hasHeader||($("#cot-header").remove(),$("#app-header").remove()),s.hasFooter||$("#app-footer").remove(),s.hasContentTop||$("#app-content-top").remove(),s.hasContentRight||($("#app-content-left").removeClass("col-md-8"),$("#app-content-right").remove()),s.hasContentLeft||$("#app-content-left").remove(),s.hasContentBottom||$("#app-content-bottom").remove(),applyFontSize(),$("#appDisplay").removeClass("hide"),s.isRendered=!0,e()}),this},cot_app.prototype.showTerms=function(e,t,a,s,i,o){var r=this,n=arguments;"agree"!=getCookie(a)?$(s).load(r.baseUrl+"html/cot_template_terms.html #cot-template-terms",function(c,l,p){$("#cot-terms-title h2").html(o||"Terms of Use Agreement"),$("#cot-terms-body").html(e),$("#cot-terms-agree").click(function(){setCookie(a,"agree"),i()}),$("#cot-terms-disagree").click(function(){$(s).load(r.baseUrl+"html/cot_template_terms.html #cot-template-terms-disagree",function(e,a,s){$("#cot-terms-return").click(function(){r.showTerms.apply(r,n)}),$("#cot-terms-body").html(t),$("#cot-terms").removeClass("hide")})}),$("#cot-terms").removeClass("hide")}):i()},cot_app.prototype.setNOC=function(e){$("#nocModalBody").html(e)},cot_app.prototype.showNOC=function(){$("#nocModal").modal()},cot_app.prototype.setContent=function(e){var t=this;$.each(["top","right","bottom","left","nav"],function(a,s){void 0!==e[s]&&$(t.getContentContainerSelector(s)).html(e[s])})},cot_app.prototype.addForm=function(e,t,a){if(a=void 0===a||a){var s={};s[t]="",this.setContent(s)}e.render({target:this.getContentContainerSelector(t)})},cot_app.prototype.getContentContainerSelector=function(e){return"nav"==e?"#app-nav-left":"#app-content-"+e};